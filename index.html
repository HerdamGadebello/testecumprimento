<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz de Francês</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&family=Rockwell&family=Franklin+Gothic+Demi&display=swap" rel="stylesheet">
    <style>
        .fade-out {
            animation: fadeOut 1s ease-out forwards;
        }
        .fade-in {
            animation: fadeIn 1s ease-in forwards;
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; display: none; }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .option:hover {
            background-color: #C6B9DD;
            transform: scale(1.05);
            transition: all 0.3s ease;
        }
        /* Ensure font for Franklin Gothic Heavy */
        .font-franklin-gothic-heavy {
            font-family: 'Franklin Gothic Demi', sans-serif;
            font-weight: 900;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center font-poppins">
    <!-- Intro Video Section -->
    <div id="intro-section" class="flex items-center justify-center w-full h-screen bg-[#062250]">
        <video id="intro-video" class="max-w-[80%] md:max-w-[60%] lg:max-w-[40%]" autoplay muted>
            <source src="VIDEOINTRO.mp4" type="video/mp4">
            Seu navegador não suporta o elemento de vídeo.
        </video>
        <audio id="intro-audio" preload="auto">
            <source src="SOMINTRO.mp3" type="audio/mp3">
            Seu navegador não suporta o elemento de áudio.
        </audio>
    </div>

    <!-- Page 2: Mascot and Start Button -->
    <div id="page-2" class="hidden flex-col items-center justify-center w-full h-screen bg-[#F1E1AC]">
        <img src="MASCOTENEUTRO.png" alt="Mascote Neutro" class="w-[70%] md:w-[50%] lg:w-[40%] mb-8 mt-[-10%]">
        <button id="start-button" class="bg-[#002F6C] text-white text-xl md:text-2xl font-franklin-gothic-demi py-4 px-8 rounded-full hover:bg-[#007BA7] transition-all">
            INICIAR EXERCÍCIO
        </button>
    </div>

    <!-- Quiz Section -->
    <div id="quiz-section" class="hidden relative flex-col items-center justify-center w-full h-screen bg-[#F4F1EC] p-4">
        <img src="LOGODAMIAO.png" alt="Logo Damião" class="absolute top-4 left-4 w-[100px] md:w-[150px]">
        <div class="relative bg-[#002F6C] rounded-2xl p-6 w-full max-w-[90%] md:max-w-[70%] lg:max-w-[50%] flex flex-col items-center">
            <img src="MASCOTENINHO.png" alt="Mascote Ninho" class="absolute bottom-4 left-4 w-[80px] md:w-[100px]">
            <div class="bg-[#C8102E] text-white text-center text-lg md:text-xl font-rockwell py-4 px-6 rounded-full -mt-12 w-[80%]">
                Escolha a alternativa que melhor traduz a seguinte palavra:
 “

            </div>
            <div class="mt-6 flex flex-col items-center w-full">
                <audio id="word-audio" controls>
                    <source src="" type="audio/mp3">
                </audio>
                <div id="french-word" class="text-3xl md:text-4xl font-franklin-gothic-heavy text-black my-4"></div>
                <div id="options" class="grid grid-cols-1 md:grid-cols-2 gap-4 w-full">
                    <!-- Options will be dynamically inserted here -->
                </div>
                <div id="result" class="mt-6 text-xl md:text-2xl font-franklin-gothic-demi text-[#3B8C59]"></div>
            </div>
        </div>
        <div class="flex justify-between w-full max-w-[90%] md:max-w-[70%] lg:max-w-[50%] mt-4">
            <button id="back-button" class="bg-[#007BA7] text-white py-2 px-6 rounded-full hover:bg-[#10C894] transition-all">VOLTAR</button>
            <button id="next-button" class="bg-[#007BA7] text-white py-2 px-6 rounded-full hover:bg-[#10C894] transition-all">AVANÇAR</button>
        </div>
    </div>

    <!-- Result Section -->
    <div id="result-section" class="hidden flex-col items-center justify-center w-full h-screen bg-[#F4F1EC] p-4">
        <div class="bg-[#C8102E] rounded-2xl p-6 w-full max-w-[90%] md:max-w-[70%] lg:max-w-[50%] flex flex-col items-center">
            <div id="result-title" class="text-3xl md:text-4xl font-franklin-gothic-demi text-white"></div>
            <div id="result-message" class="text-lg md:text-xl font-poppins text-white mt-4 text-center"></div>
            <img id="result-mascot" src="" alt="Mascote Resultado" class="w-[60%] md:w-[40%] lg:w-[30%] mt-6">
        </div>
    </div>

    <audio id="button-audio" src="BUTTON.mp3"></audio>
    <audio id="win-audio" src="WIN.wav"></audio>
    <audio id="error-audio" src="ERROR.wav"></audio>
    <audio id="result-audio" src=""></audio>

    <script>
        const quizData = [
            { word: "Bonjour", correct: "Bom dia", options: ["Bom dia", "Boa noite", "Olá", "Tchau"], audio: "bonjour.m4a" },
            { word: "Salut", correct: "Olá", options: ["Olá", "Obrigado(a)", "Por favor", "Boa noite"], audio: "salut.mp3" },
            { word: "Merci", correct: "Obrigado(a)", options: ["Obrigado(a)", "Perdão", "De nada", "Até logo"], audio: "merci.mp3" },
            { word: "Coucou", correct: "Oi", options: ["Oi", "Bom dia", "Boa tarde", "Tchau"], audio: "coucou.mp3" },
            { word: "S'il te plaît", correct: "Por favor (uso informal)", options: ["Por favor (uso informal)", "Obrigado(a)", "Perdão", "De nada"], audio: "s'il te plaît.mp3" },
            { word: "S'il vous plaît", correct: "Por favor (uso formal)", options: ["Por favor (uso formal)", "Olá", "Boa noite", "Até breve"], audio: "s'il vous plaît.mp3" },
            { word: "Pardon", correct: "Perdão", options: ["Perdão", "Obrigado(a)", "Oi", "Boa tarde"], audio: "pardon.mp3" },
            { word: "De rien", correct: "De nada", options: ["De nada", "Por favor", "Olá", "Tchau"], audio: "de rien.mp3" },
            { word: "À bientôt", correct: "Até breve", options: ["Até breve", "Boa noite", "Obrigado(a)", "Oi"], audio: "à bientôt.mp3" },
            { word: "Au revoir", correct: "Tchau", options: ["Tchau", "Bom dia", "Por favor", "Perdão"], audio: "au revoir.mp3" },
            { word: "Bonne nuit", correct: "Boa noite (despedida)", options: ["Boa noite (despedida)", "Boa tarde", "Olá", "De nada"], audio: "bonne nuit.mp3" },
            { word: "Bonne soirée", correct: "Tenha uma boa noite", options: ["Tenha uma boa noite", "Bom dia", "Obrigado(a)", "Por favor"], audio: "bonne soirée.mp3" },
            { word: "Bonsoir", correct: "Boa noite (cumprimento)", options: ["Boa noite (cumprimento)", "Até logo", "Oi", "Perdão"], audio: "bonsoir.mp3" },
            { word: "Bonne journée", correct: "Tenha um bom dia", options: ["Tenha um bom dia", "Boa tarde", "Obrigado(a)", "Olá"], audio: "bonne journée.mp3" },
            { word: "Bon après-midi", correct: "Boa tarde", options: ["Boa tarde", "Bom dia", "Tchau", "Por favor"], audio: "bon après midi.mp3" },
            { word: "Moi, c'est...", correct: "Eu sou", options: ["Eu sou", "Boa noite", "Perdão", "Oi"], audio: "moi c'est.mp3" },
            { word: "Je m'appelle...", correct: "Eu me chamo", options: ["Eu me chamo", "Obrigado(a)", "Até breve", "Boa tarde"], audio: "je m'apelle.mp3" }
        ];

        let currentQuestion = 0;
        let score = 0;
        const totalQuestions = quizData.length;

        const introSection = document.getElementById('intro-section');
        const page2 = document.getElementById('page-2');
        const quizSection = document.getElementById('quiz-section');
        const resultSection = document.getElementById('result-section');
        const introVideo = document.getElementById('intro-video');
        const introAudio = document.getElementById('intro-audio');
        const startButton = document.getElementById('start-button');
        const backButton = document.getElementById('back-button');
        const nextButton = document.getElementById('next-button');
        const wordAudio = document.getElementById('word-audio');
        const frenchWord = document.getElementById('french-word');
        const optionsContainer = document.getElementById('options');
        const resultDisplay = document.getElementById('result');
        const buttonAudio = document.getElementById('button-audio');
        const winAudio = document.getElementById('win-audio');
        const errorAudio = document.getElementById('error-audio');
        const resultAudio = document.getElementById('result-audio');
        const resultTitle = document.getElementById('result-title');
        const resultMessage = document.getElementById('result-message');
        const resultMascot = document.getElementById('result-mascot');

        // Synchronize video and audio playback
        introVideo.addEventListener('loadeddata', () => {
            introVideo.play().then(() => {
                introAudio.play().catch(err => {
                    console.error('Failed to play SOMINTRO.mp3:', err);
                    // Fallback: Proceed to Page 2 if audio fails
                    transitionToPage2();
                });
            }).catch(err => {
                console.error('Failed to play VIDEOINTRO.mp4:', err);
                // Fallback: Proceed to Page 2 if video fails
                transitionToPage2();
            });
        });

        introVideo.addEventListener('error', () => {
            console.error('Failed to load VIDEOINTRO.mp4. Check file path or format.');
            transitionToPage2();
        });

        introAudio.addEventListener('error', () => {
            console.error('Failed to load SOMINTRO.mp3. Check file path or format.');
            transitionToPage2();
        });

        // Transition when both video and audio end
        let videoEnded = false;
        let audioEnded = false;

        introVideo.addEventListener('ended', () => {
            videoEnded = true;
            if (audioEnded || introAudio.paused) {
                transitionToPage2();
            }
        });

        introAudio.addEventListener('ended', () => {
            audioEnded = true;
            if (videoEnded || introVideo.paused) {
                transitionToPage2();
            }
        });

        // Fallback timeout in case media doesn't load or play
        setTimeout(() => {
            if (!videoEnded && !audioEnded) {
                console.warn('Media playback timeout. Transitioning to Page 2.');
                transitionToPage2();
            }
        }, 15000); // 15 seconds fallback

        function transitionToPage2() {
            introSection.classList.add('fade-out');
            setTimeout(() => {
                introSection.classList.add('hidden');
                page2.classList.remove('hidden');
                page2.classList.add('fade-in');
            }, 1000);
        }

        startButton.addEventListener('click', () => {
            buttonAudio.play();
            page2.classList.add('fade-out');
            setTimeout(() => {
                page2.classList.add('hidden');
                quizSection.classList.remove('hidden');
                quizSection.classList.add('fade-in');
                loadQuestion();
            }, 1000);
        });

        backButton.addEventListener('click', () => {
            buttonAudio.play();
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion();
            }
        });

        nextButton.addEventListener('click', () => {
            buttonAudio.play();
            if (currentQuestion < totalQuestions - 1) {
                currentQuestion++;
                loadQuestion();
            } else {
                showResults();
            }
        });

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function loadQuestion() {
            const question = quizData[currentQuestion];
            wordAudio.src = question.audio;
            frenchWord.textContent = question.word;
            resultDisplay.textContent = '';
            optionsContainer.innerHTML = '';
            const shuffledOptions = shuffleArray([...question.options]);
            shuffledOptions.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.className = 'option bg-[#F5C84C] text-black py-2 px-4 rounded-lg text-lg md:text-xl hover:bg-[#C6B9DD] transition-all';
                button.addEventListener('click', () => checkAnswer(option, question.correct));
                optionsContainer.appendChild(button);
            });
            backButton.disabled = currentQuestion === 0;
            optionsContainer.classList.add('fade-in');
        }

        function checkAnswer(selected, correct) {
            if (selected === correct) {
                resultDisplay.textContent = 'CORRETO';
                resultDisplay.classList.add('text-[#3B8C59]');
                winAudio.play();
                score++;
            } else {
                resultDisplay.textContent = 'INCORRETO';
                resultDisplay.classList.add('text-[#C8102E]');
                errorAudio.play();
            }
            optionsContainer.querySelectorAll('button').forEach(btn => btn.disabled = true);
        }

        function showResults() {
            quizSection.classList.add('fade-out');
            setTimeout(() => {
                quizSection.classList.add('hidden');
                resultSection.classList.remove('hidden');
                resultSection.classList.add('fade-in');
                const percentage = (score / totalQuestions) * 100;
                if (percentage >= 95) {
                    resultTitle.textContent = 'EXCELENTE';
                    resultMessage.textContent = `Você acertou ${score}, continue assim, um excelente resultado`;
                    resultMascot.src = 'MASCOTEFELIZ.png';
                    resultAudio.src = 'POSITIVO.mp3';
                } else if (percentage >= 75) {
                    resultTitle.textContent = 'PARABÉNS';
                    resultMessage.textContent = `Você acertou ${score}, continue assim, um bom resultado`;
                    resultMascot.src = 'MASCOTEALEGRE.png';
                    resultAudio.src = 'POSITIVO.mp3';
                } else if (percentage >= 60) {
                    resultTitle.textContent = 'QUASE LÁ';
                    resultMessage.textContent = `Você acertou ${score}, não é um resultado ruim, mas também não é um bom resultado`;
                    resultMascot.src = 'MASCOTEDUVIDA.png';
                    resultAudio.src = 'NEGATIVO.mp3';
                } else {
                    resultTitle.textContent = 'NÃO FOI DESSA VEZ';
                    resultMessage.textContent = `Você acertou ${score}, um resultado abaixo do esperado`;
                    resultMascot.src = 'MASCOTEDUVIDA.png';
                    resultAudio.src = 'NEGATIVO.mp3';
                }
                resultAudio.play();
            }, 1000);
        }
    </script>
</body>
</html>
